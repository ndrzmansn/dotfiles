{"mode":"editor","version":1,"windowDimensions":{"x":1920,"y":22,"width":1920,"height":1054},"syntax":{"deserializer":"Syntax","grammarOverridesByPath":{}},"project":{"path":"/Users/zwei/Workspace/zippy/graal/com.oracle.graal.phases.common/src/com/oracle/graal/phases/common/inlining/info","buffers":[{"text":"/*\n * Copyright (c) 2013, Oracle and/or its affiliates. All rights reserved.\n * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n *\n * This code is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License version 2 only, as\n * published by the Free Software Foundation.\n *\n * This code is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n * version 2 for more details (a copy is included in the LICENSE file that\n * accompanied this code).\n *\n * You should have received a copy of the GNU General Public License version\n * 2 along with this work; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n *\n * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n * or visit www.oracle.com if you need additional information or have any\n * questions.\n */\npackage com.oracle.graal.phases.common.inlining.info;\n\nimport java.util.*;\n\nimport com.oracle.graal.api.code.Assumptions;\nimport com.oracle.graal.api.meta.MetaAccessProvider;\nimport com.oracle.graal.api.meta.MetaUtil;\nimport com.oracle.graal.api.meta.ResolvedJavaMethod;\nimport com.oracle.graal.nodes.Invoke;\nimport com.oracle.graal.phases.common.inlining.InliningUtil;\nimport com.oracle.graal.phases.util.Providers;\nimport com.oracle.graal.api.code.Assumptions.Assumption;\nimport com.oracle.graal.graph.*;\nimport com.oracle.graal.nodes.java.MethodCallTargetNode.InvokeKind;\n\n/**\n * Represents an inlining opportunity where the current class hierarchy leads to a monomorphic\n * target method, but for which an assumption has to be registered because of non-final classes.\n */\npublic class AssumptionInlineInfo extends ExactInlineInfo {\n\n    private final Assumption takenAssumption;\n\n    public AssumptionInlineInfo(Invoke invoke, ResolvedJavaMethod concrete, Assumption takenAssumption) {\n        super(invoke, concrete);\n        this.takenAssumption = takenAssumption;\n    }\n\n    @Override\n    public Collection<Node> inline(Providers providers, Assumptions assumptions) {\n        assumptions.record(takenAssumption);\n        return super.inline(providers, assumptions);\n    }\n\n    @Override\n    public void tryToDevirtualizeInvoke(MetaAccessProvider metaAccess, Assumptions assumptions) {\n        assumptions.record(takenAssumption);\n        InliningUtil.replaceInvokeCallTarget(invoke, graph(), InvokeKind.Special, concrete);\n    }\n\n    @Override\n    public String toString() {\n        return \"assumption \" + MetaUtil.format(\"%H.%n(%p):%r\", concrete);\n    }\n}\n","markers":{"markers":{"1":{"id":1,"range":[[17,2],[17,2]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":12,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/zwei/Workspace/zippy/graal/com.oracle.graal.phases.common/src/com/oracle/graal/phases/common/inlining/info/AssumptionInlineInfo.java","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"507614a7b16c2bc847f28ab5ce7f6bd8963a0058","deserializer":"TextBuffer"}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"items":[{"id":12,"softTabs":true,"displayBuffer":{"id":13,"softWrap":false,"editorWidthInChars":170,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/zwei/Workspace/zippy/graal/com.oracle.graal.phases.common/src/com/oracle/graal/phases/common/inlining/info/AssumptionInlineInfo.java","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"}],"activeItemUri":"/Users/zwei/Workspace/zippy/graal/com.oracle.graal.phases.common/src/com/oracle/graal/phases/common/inlining/info/AssumptionInlineInfo.java","focused":true,"active":true,"deserializer":"Pane"},"deserializer":"PaneContainer"},"fullScreen":false,"deserializer":"Workspace"},"packageStates":{"fuzzy-finder":{"/Users/zwei/Workspace/zippy/graal/com.oracle.graal.phases.common/src/com/oracle/graal/phases/common/inlining/info/AssumptionInlineInfo.java":1401410559299},"keybinding-resolver":{"attached":false},"metrics":{"sessionLength":4006},"tree-view":{"directoryExpansionStates":{},"selectedPath":"/Users/zwei/Workspace/zippy/graal/com.oracle.graal.phases.common/src/com/oracle/graal/phases/common/inlining/info/AssumptionInlineInfo.java","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}}}